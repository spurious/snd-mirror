
(define noid-min-peak-phases (vector

#(1  1.0    #(0))

#(2  1.76   #(0 0))

#(3  1.980  #(0 23/39 6/19)
            #(0 16/39 32/19)
            #(0 62/39 6/19)
            #(0 55/39 32/19)
            #(0 31/22 37/22)
	    ;; best found by hand search of the graph: [-0.010 1.271 5.265] noid3a 203838
     1.98053356757571 #(0 7/17 59/35))

#(4  2.050  #(0 45/37 25/31 8/7)
     2.040  #(0 33/35 67/50 10/9)
            ;; graph: [-0.010 0.329 2.198 6.157] noid4
            #(0 1/9 17/24 71/36))

#(5  2.361  #(0 59/71 68/41 43/30 61/38)
     2.358  #(0 31/27 14/45 10/19 6/17)
            #(0 1/7 14/45 65/42 16/43)
     2.353  #(0 3/20 52/155 30/19 2/5)) ; better than my graph noid5

#(6  2.567  #(0 36/19 7/25 18/55 23/17 5/26)
     2.562  #(0 23/26 10/39 57/44 33/25 68/59)
     2.557  #(0 55/62 9/35 57/44 29/22 38/33))

#(7  2.708 #(0 5/31 35/31 24/19 23/27 23/15 29/26))

#(8  3.008  #(0 41/45 135/71 32/21 13/16 13/16 24/31 27/22)
     3.003  #(0 22/27 54/29 39/28 31/40 53/74 9/11 59/50))

#(9  3.202  #(0 1/83 578/385 56/33 17/76 13/64 87/61 3/4 54/35)
     3.181  #(0 21/22 107/57 2/25 5/6 18/41 37/24 43/25 34/25))


#(10 3.4332 #(0 2/27 41/23 3/20 33/40 29/21 51/31 18/19 9/53 25/19))

#(11 3.5519 #(0 28/29 4/27 4/23 34/33 67/34 11/30 1/13 33/31 31/22 19/17))

#(12 3.9110 #(0 1/14 9/58 3/47 9/37 27/17 25/14 4/7 17/24 1/22 31/24 11/45)
     3.8666 #(0 43/34 22/15 9/37 3/46 167/111 103/52 3/38 30/17 15/22 35/24 63/62))

#(13 4.0798 #(0 3/32 1/44 76/43 17/33 17/25 21/23 3/16 60/31 19/18 11/72 57/80 67/39)
     4.0411 #(0 25/17 83/104 58/49 59/35 5/14 36/19 39/40 35/22 71/50 27/23 47/34 7/32))

#(14 4.2167 #(0 22/17 2/19 31/18 20/13 23/28 15/17 61/107 107/106 2/29 6/7 
              21/23 79/57 56/167)
     4.1992 #(0 14/55 80/51 1/18 175/262 71/80 23/24 42/29 5/7 31/33 16/33 
              23/16 16/17 14/57))

#(15 4.3725 #(0 39/59 157/196 10/13 31/21 38/33 17/31 34/23 37/68 146/147 
	      29/41 12/19 3/10 35/24 59/33))

#(16 4.6967 #(0 72/49 91/73 115/74 17/22 2/13 53/31 35/22 51/26 5/23 31/29 
	      12/11 28/39 45/31 43/67 21/19)
     4.6353 #(0 42/43 27/38 37/23 19/37 11/45 19/39 372/223 55/63 11/7 52/29 
	      61/50 32/25 50/59 19/12 67/40))

#(17 4.7650 #(0 1/216 14/43 172/123 1/17 72/59 69/37 51/73 1/20 1/43 
              17/41 1/9 55/32 13/17 13/20 13/8 61/31))

#(18 4.9811 #(0 11/23 21/13 9/20 3/25 32/25 7/55 7/15 27/28 25/32 46/31 
              5/16 5/14 15/68 3/28 53/37 19/27 27/35)
     4.9449 #(0 25/19 11/15 4/15 3/10 23/18 196/131 105/62 4/11 8/33 97/56 
              1/10 41/23 1/18 8/29 93/73 6/37 20/19))

#(19 5.0555 #(0 9/89 24/95 51/127 1/12 63/88 53/34 3/13 9/22 112/75 11/7 23/29 
              59/178 1/83 44/39 1/18 91/73 16/31 8/9)
     5.0530 #(0 3/23 22/21 7/4 47/33 16/63 22/21 5/11 141/76 79/46 23/31 9/23 
	      16/41 15/23 8/5 128/69 2/17 25/14 1/15))


#(20 5.2638 #(0 16/13 29/39 25/44 23/16 21/20 35/34 1/17 21/32 5/7 34/21 24/25 
	      49/26 67/51 9/59 41/30 52/29 32/57 49/74 37/52))

#(21 5.3575 #(0 11/27 1/25 87/44 29/21 45/34 45/26 25/26 59/49 2/11 37/40 61/35 
	      59/58 6/61 45/49 58/83 3/20 34/57 31/42 20/19 38/35)
     5.3539 #(0 59/33 39/22 39/22 10/23 7/55 11/47 28/41 47/27 124/69 9/31 1/24 
              46/33 120/83 11/30 8/21 40/31 9/31 26/23 1/14 63/37))

#(22 5.7811 #(0 43/34 23/16 17/29 31/23 14/23 17/11 2/35 69/43 220/219 86/45 15/13 
	      11/30 41/23 27/16 2/5 11/19 34/39 23/20 32/31 32/41 6/19)
     5.6386 #(0 1/2 11/31 41/31 5/6 1/24 167/91 4/19 7/10 25/28 1/6 32/53 23/18 138/85 
              46/27 31/23 35/37 138/79 18/23 67/34 11/18 41/25))

#(23 5.7719 #(0 2/23 17/44 36/47 9/14 5/37 27/37 53/34 101/67 67/38 19/26 19/26 29/17 
	      13/7 69/43 1/16 32/25 1/20 26/17 82/71 11/25 8/81 22/25))

#(24 5.7995 #(0 19/37 1/19 3/14 1/60 1/57 9/26 13/35 19/44 21/13 107/106 59/54 9/25 
	      61/49 7/40 35/57 8/27 53/31 17/19 23/18 43/31 9/17 23/55 17/15))

#(25 6.0925 #(0 11/34 4/9 18/29 40/31 11/17 19/23 15/16 29/32 47/37 117/67 22/21 
	      9/13 5/22 19/29 21/37 2/27 23/13 5/17 37/27 37/99 44/25 15/19 33/32 55/29))

#(26 6.0483 #(0 43/31 4/39 21/26 13/46 26/61 13/15 11/25 103/90 38/31 44/23 13/16 
	      53/43 30/19 84/85 1/491 33/29 9/14 29/38 43/23 6/5 18/31 85/73 23/36 12/29 9/20))

#(27 6.5717 #(0 103/55 49/30 71/95 61/49 168/107 74/49 49/26 32/25 22/13 4/9 45/26 
	      43/28 1/25 67/56 35/43 26/25 11/8 19/66 3/5 6/11 36/19 21/22 73/122 1/5 74/59 39/25))

#(28 6.6218 #(0 29/19 8/5 3/26 13/17 142/81 69/38 156/125 37/19 83/47 2/41 43/29 9/17 
	      3/14 4/7 13/12 9/62 221/147 29/21 46/37 4/17 31/33 41/30 121/81 32/25 18/41 23/31 13/19)
     6.6208 #(0 29/21 59/32 94/93 3/20 44/39 23/14 13/23 19/25 15/16 23/30 1/23 79/43 
	      37/30 69/40 11/39 51/32 25/18 41/21 51/44 4/3 54/29 67/42 6/13 8/65 34/35 118/75 15/11))

#(29 6.7669 #(0 32/27 49/32 13/36 23/45 73/40 67/48 27/17 29/16 49/45 33/50 7/13 5/37 184/99 
	      31/40 11/20 53/47 86/49 51/50 14/85 51/37 8/13 124/73 39/31 91/57 1/71 67/39 4/21 25/29))


#(30 6.8783 #(0 3/2 27/19 43/25 13/16 1/24 15/74 53/59 7/30 28/25 7/31 14/11 13/31 5/11 
	      27/34 90/49 35/29 185/104 67/37 46/25 11/9 17/28 14/25 85/49 41/39 2/29 13/7 
	      17/13 33/19 1/46))

#(31 7.0052 #(0 19/17 1/15 39/41 33/20 5/6 25/26 50/99 25/44 63/110 50/49 1/11 157/315 
	      13/21 43/31 31/26 44/45 51/32 288/157 58/33 29/51 18/47 33/58 103/52 3/26 
	      52/37 11/27 35/19 37/36 5/44 6/35))

#(32 7.2150  #(0 41/35 19/42 3/38 148/91 37/24 76/43 4/7 1/17 4/29
               88/59 313/188 1/30 53/40 29/17 8/25 7/26 18/11 9/29 
               6/25 248/149 6/17 95/49 76/91 54/43 26/19 16/35 73/53 
               33/29 33/23 79/41 3/13))

#(33 7.2752 #(0 68/53 432/247 7/43 57/32 28/33 29/32 41/35 15/11 32/23 23/58 14/15 50/43 125/107 
	      4/3 4/5 73/49 10/31 15/14 11/17 62/99 2/5 26/17 32/19 109/61 36/25 26/29 507/254 
	      25/14 99/119 47/27 19/25 4/25))

#(34 7.3204 #(0 15/13 15/11 22/17 19/13 29/65 88/49 54/59 27/20 23/13 33/19 53/39 44/47 
	      43/26 30/17 12/7 3/43 48/55 19/16 5/34 25/28 7/20 53/34 21/40 41/25 15/17 
	      17/12 107/64 59/60 37/58 5/41 2/35 27/41 17/26))

#(35 7.4724 #(0 20/39 13/21 27/43 21/106 31/54 1/17 50/37 25/44 49/26 39/23 10/21 14/31 13/31 
	      1/14 37/30 27/20 4/3 5/4 28/25 17/42 49/30 210/113 2/13 92/55 45/112 52/35 3/28 
	      33/38 25/14 17/41 71/59 183/184 3/16 16/51))

#(36 7.6235 #(0 54/29 19/23 50/27 36/23 65/37 1/664 17/14 27/25 6/23 266/145 29/33 48/55 21/16 
	      32/45 1/14 33/100 75/38 45/49 29/31 49/39 59/53 4/11 44/49 12/7 30/37 46/43 17/36 
	      74/43 56/55 1/190 17/29 35/19 1/21 7/16 20/27))

;280: 0.223034573435069 8.25227921709756 #<vct[len=37]: 0.662 5.225 1.505 5.404 4.439 0.921 1.210 2.308 5.989 5.773 2.567 5.999 0.104 3.558 3.425 5.897 4.750 5.258 1.805 0.597 1.841 3.530 2.041 5.433 3.466 5.240 6.529 0.160 5.758 5.737 5.535 6.099 2.553 4.858 5.554 1.941 0.218>
;  rat: #(0 36/29 24/13 43/49 9/25 35/34 71/78 43/41 1/101 45/26 1/2 29/21 22/17 2/11 27/14 46/91 83/43 47/25 4/7 81/41 5/31 19/39 110/61 39/58 145/79 7/37 7/18 3/20 31/18 158/105 91/74 139/116 145/78 8/21 11/28 32/31 3/11)


#(40 8.220  #(0 47/25 55/38 2/23 13/10 55/47 29/80 68/37 44/27 123/77 
	      50/49 18/107 26/25 55/47 21/13 3/17 15/28 28/19 16/23 23/28 
	      3/2 28/39 73/61 17/13 94/65 31/29 43/33 11/28 42/23 26/25 
	      35/43 37/21 13/20 43/24 57/31 2/3 43/60 7/24 73/51 8/55))

#(41 8.5677 #(0 8/7 11/6 31/19 21/32 27/17 45/26 59/49 25/19 71/41 21/19 45/23 8/15 
	      39/28 57/34 65/38 23/17 241/121 34/29 20/53 58/41 400/401 43/34 32/27 
	      9/38 32/17 93/58 5/16 13/38 16/27 47/74 2/5 17/22 191/381 17/43 36/23 
	      28/19 7/20 1/45 39/35 27/22)
     8.5127 #(0 5/24 1/24 11/18 26/23 7/11 34/31 14/15 22/31 11/27 58/37 21/11 50/117 
	      27/32 73/47 16/19 35/47 59/52 1/9 7/31 16/59 63/94 30/23 86/85 29/34 51/26 
	      37/41 61/45 64/65 15/14 37/26 9/22 9/19 1/74 1/4 34/19 16/23 19/31 7/27 47/29 17/74))

#(42 8.6663 #(0 11/6 1 47/33 29/16 8/25 6/7 11/8 22/29 43/37 31/21 15/8 37/25 37/34 
	      5/7 55/36 129/71 32/23 11/14 51/28 31/29 25/33 1/296 60/59 52/29 167/333 
	      20/17 14/19 1/14 46/41 18/19 17/20 79/43 5/22 61/36 1/8 49/31 41/28 11/25 
	      12/19 7/22 62/49))

#(43 8.6881 #(0 3/34 57/43 62/53 33/23 31/34 31/20 27/31 1/20 14/27 189/283 23/25 41/34 
	      49/58 56/55 205/103 28/25 4/9 53/27 7/18 66/79 45/23 11/25 3/25 4/11 40/47 
	      53/32 7/6 45/44 5/13 19/21 80/51 28/29 19/16 1/48 37/62 13/25 59/45 35/19 
	      7/4 61/56 4/9 107/58))

#(44 8.5912 #(0 3/11 5/18 27/22 32/23 4/15 17/27 66/43 34/25 19/17 15/56 10/27 109/87 59/47 
	      9/8 157/94 1/282 21/22 30/17 2/3 54/37 23/14 1/21 14/11 26/87 41/24 5/9 19/13 
	      2/13 34/33 59/71 23/15 131/75 37/23 1/24 212/113 90/49 23/32 18/55 5/7 5/28 
	      1/20 53/34 67/43))

#(45 8.7655 #(0 3/5 1/22 4/13 13/24 52/105 97/82 1/26 73/81 17/23 53/73 11/17 87/86 12/31 
	      14/113 23/49 15/8 172/103 43/23 61/44 23/32 3/14 37/25 21/17 146/97 67/41 21/38 
	      53/27 9/28 25/21 13/43 28/85 48/31 43/85 29/52 35/31 77/53 12/97 26/31 89/45 
	      37/25 65/38 34/29 19/37 29/23))

#(46 9.1093 #(0 1/23 41/30 9/13 1/41 70/51 37/33 52/37 89/67 23/17 1/59 17/10 49/34 17/18 
	      27/16 7/32 13/29 9/14 15/13 3/11 92/67 35/43 17/21 67/51 13/24 11/10 23/21 
	      35/24 3/7 9/19 20/27 41/30 11/15 53/39 42/23 39/50 137/80 52/31 13/18 23/12 
	      244/133 39/20 31/18 53/42 88/59 29/30))

#(47 9.3426 #(0 11/25 18/31 48/29 29/36 21/13 101/55 89/52 28/29 22/15 23/17 34/61 1/64 
	      22/65 1/60 39/47 56/37 33/58 53/40 19/22 27/28 23/22 19/22 31/19 32/33 6/23 
	      59/39 45/23 13/21 11/28 40/63 19/75 97/53 58/37 43/24 29/16 1/4 13/32 69/38 
	      19/52 15/19 71/41 155/82 15/23 28/93 8/23 93/70))

;7380: 0.198140965799295 9.31262539256685 #<vct[len=47]: 6.249 0.538 4.075 1.714 5.279 4.032 0.266 3.803 2.191 4.369 1.377 5.915 2.698 2.128 4.348 2.688 4.299 5.924 4.041 1.629 1.142 4.965 1.821 5.478 5.850 4.220 4.321 2.256 1.725 4.420 -0.341 3.571 0.417 2.204 1.176 4.048 0.234 1.516 1.567 4.162 5.423 4.387 3.476 3.825 0.494 1.644 1.691>
;  rat: #(0 5/26 133/100 23/39 59/34 27/20 5/31 74/57 43/54 3/2 14/25 1/67 555/554 64/77 48/31 32/31 14/9 1/12 157/105 17/23 19/32 82/45 5/6 1/135 3/22 44/27 97/58 39/38 46/53 33/19 10/43 64/43 53/107 43/40 19/25 32/19 13/27 9/10 51/55 30/17 3/17 249/134 30/19 131/77 15/23 35/34 19/18)


#(50 9.8335 #(0 21/17 134/73 188/113 43/34 8/25 6/11 9/7 14/23 37/29 41/38 71/58 47/55 16/19 
	      6/13 265/177 212/127 3/29 33/29 51/26 23/19 115/74 44/29 6/7 26/21 24/29 12/7 
	      57/32 5/14 4/27 110/61 37/53 18/37 1/5 55/41 107/61 62/35 57/29 19/24 9/53 1/14 
	      1 185/139 66/35 473/237 31/18 145/144 99/56 15/29 5/23))


#(51 9.7827 #(0 7/69 1/8 9/10 32/53 156/155 23/24 11/6 9/38 79/41 1/9 6/23 115/64 65/36 25/17 
	      57/43 27/41 130/87 44/31 69/37 37/24 43/48 11/50 135/86 9/37 7/38 21/11 20/29 55/47 
	      3/28 5/28 20/13 4/7 7/18 68/47 115/72 4/59 38/101 64/55 29/21 7/18 48/29 23/28 23/21 
	      27/53 4/19 20/23 15/11 26/17 9/20 57/35))

#(52 9.9780 #(0 159/160 6/13 11/12 21/25 30/17 15/22 53/46 17/20 3/2 36/19 29/17 44/31 53/36 25/31 
	      57/29 42/31 17/18 24/29 63/44 43/29 7/34 23/15 61/107 7/31 47/34 7/23 1/33 90/47 86/49 
	      62/43 59/74 43/41 16/13 38/31 16/11 3/26 8/17 13/12 268/153 8/17 73/55 14/11 73/91 4/13 
	      20/23 26/31 31/24 5/42 13/16 3/32 39/25))

#(53 9.8960 #(0 72/61 63/79 28/55 23/52 34/31 8/39 42/23 31/21 97/73 7/25 29/72 11/24 17/28 
	      35/27 25/33 9/19 10/13 8/21 50/37 49/29 27/20 76/75 35/41 5/29 21/25 47/25 35/26 
	      122/69 19/27 9/8 42/31 23/22 1/117 25/32 38/33 173/101 17/32 129/71 49/26 7/18 
	      18/35 26/15 50/31 85/54 118/105 1/52 8/5 29/30 44/43 31/42 29/25 7/4))

;3172: 0.189594193230604 10.2380864344526 #<vct[len=54]: 1.008 5.275 5.251 5.129 2.712 3.105 3.782 0.421 5.686 3.707 5.364 5.326 5.673 4.697 3.575 1.009 4.535 2.312 4.982 2.097 5.561 5.312 3.916 3.024 0.832 3.221 2.558 4.526 0.354 0.417 1.497 1.702 0.962 2.165 4.374 4.952 1.591 2.263 0.466 1.711 2.965 1.763 1.800 5.740 2.203 2.789 3.633 4.060 0.487 5.316 4.856 4.248 5.414 1.356>
;  rat: #(0 27/26 17/24 7/20 34/27 33/31 23/24 58/37 12/13 71/36 5/28 24/13 18/11 215/214 16/49 44/37 217/109 26/27 88/59 23/91 30/29 33/52 43/23 43/34 17/69 24/35 2/13 23/50 43/53 24/47 8/15 5/18 31/18 66/37 1/6 1/33 23/36 25/47 41/25 12/7 52/29 12/11 25/32 12/7 11/41 2/15 4/49 55/29 18/41 48/29 19/16 31/46 21/29 10/9)

;4901: 0.189252900846147 10.2196566456919 #<vct[len=54]: 3.854 3.055 1.394 4.490 1.261 2.789 0.715 -0.039 0.188 1.216 -0.353 3.555 0.034 1.226 3.376 4.576 2.717 5.213 3.619 6.258 1.561 1.812 3.001 5.886 3.432 2.032 5.520 4.450 5.177 1.421 2.675 5.543 2.458 6.053 6.158 0.604 3.540 2.983 0.689 1.045 2.091 5.809 3.045 2.980 1.164 5.355 1.493 1.127 0.661 2.605 2.747 1.976 2.303 2.130>
;  rat: #(0 14/27 16/21 12/23 4/15 29/19 41/25 5/29 58/57 2/17 9/23 9/22 2/33 17/14 53/79 42/23 1/136 63/40 46/25 16/11 19/26 103/65 14/19 56/131 13/31 56/75 17/27 17/16 1/15 51/31 58/71 86/171 5/17 4/19 57/56 1/43 45/26 15/46 7/19 54/43 17/47 7/22 7/33 27/28 51/44 19/15 17/21 22/15 1/11 43/29 19/63 29/35 29/17 14/33)

#(60 10.861 #(0 212/141 11/9 43/30 47/25 31/22 7/26 187/104 11/26 121/64 2/15 251/137 
	      6/23 128/69 37/38 16/23 42/29 101/81 107/63 17/28 1/76 29/33 5/59 41/22 
	      33/23 28/43 59/30 179/90 49/38 17/26 23/22 117/70 4/11 67/56 5/42 182/97 
	      10/59 45/77 32/19 83/46 16/25 1 86/57 11/38 61/44 57/43 2/31 17/18 193/116 
	      31/33 23/20 82/55 22/17 43/37 173/91 33/23 4/31 29/25 16/19 8/13))

#(61 10.718 #(0 8/55 59/38 47/29 13/18 68/135 51/35 41/26 25/33 13/20 32/23 11/16 27/40 
	      3/23 7/6 22/17 23/22 22/35 52/69 23/29 3/19 32/17 49/31 9/14 123/77 53/105 
	      5/14 41/44 4/13 43/44 57/29 29/17 6/17 5/19 19/36 40/27 1/14 73/47 70/39 
	      35/39 13/11 87/65 31/24 24/19 58/31 6/31 15/8 31/25 9/25 37/23 17/27 20/13 
	      66/35 17/20 3/43 5/3 59/33 1/10 53/27 8/47 53/36))

#(62 10.611 #(0 49/44 51/52 68/35 85/86 17/35 4/13 47/30 19/85 1/14 19/39 102/59 28/39 
	      17/32 22/13 31/26 2/9 175/88 5/38 11/16 32/35 7/24 21/13 37/32 61/42 47/30 
	      78/43 3/37 21/13 11/37 13/25 25/38 29/16 2/7 11/23 59/76 17/33 29/30 67/46 
	      33/50 16/23 40/21 10/19 22/13 38/33 17/14 17/38 29/51 46/37 4/11 33/46 97/53 
	      2/33 54/31 62/39 8/5 7/41 33/26 87/109 36/23 80/53 61/33))

#(63 11.291 #(0 71/141 41/26 27/20 62/35 58/41 67/50 10/7 8/13 16/23 51/28 1/3 5/29 44/31 
	      23/42 50/57 26/25 13/11 55/31 31/33 49/25 36/37 1/17 3/38 17/32 17/11 2/15 
	      103/104 50/31 43/24 17/12 14/17 31/25 17/28 137/76 59/45 51/70 161/94 29/26 
	      17/21 40/29 40/23 145/79 3/28 96/95 19/20 9/31 97/83 63/41 34/79 51/28 56/57 
	      16/33 23/37 9/44 24/49 23/29 21/25 8/19 9/19 58/59 17/13 7/11))

#(64 10.968 #(0 47/33 170/113 58/57 7/27 89/46 29/24 55/47 15/29 
	      8/31 71/52 4/43 275/183 11/19 56/33 2/27 58/31 48/37 
	      7/12 31/18 17/10 75/38 69/68 32/17 106/85 13/40 20/39 
	      72/55 1 21/16 103/69 33/20 44/25 74/61 40/53 17/26 3/2 
	      10/33 9/19 22/73 5/8 26/33 1/9 13/7 140/139 124/79 13/8 
	      171/257 25/31 39/29 15/34 25/62 46/139 56/29 60/37 1/12 
	      17/16 7/41 26/87 6/53 5/13 43/23 25/32 23/24))

;786: 0.181407910993919 11.7915142146048 #<vct[len=65]: 2.416 4.279 1.272 0.243 2.610 5.326 3.906 4.390 2.490 0.136 5.659 5.087 2.394 3.386 4.833 1.744 0.559 1.407 1.158 6.076 2.295 4.734 3.575 5.377 4.684 6.052 5.582 4.036 3.458 5.456 2.722 2.424 6.147 5.215 4.268 3.576 5.458 0.063 1.252 0.880 5.280 1.804 1.588 1.876 3.018 6.243 3.629 6.127 0.507 5.046 6.065 4.664 4.065 0.958 3.274 4.818 2.661 5.743 0.602 2.843 2.233 4.438 1.246 4.586 0.280>
;  rat: #(0 31/17 4/41 783/782 68/69 40/37 80/43 61/49 58/31 6/17 47/35 9/23 13/17 19/61 1/318 1/4 21/19 20/33 58/33 31/56 18/31 10/17 29/20 59/47 13/49 85/44 75/74 184/105 4/5 2/3 37/36 7/43 11/19 53/35 39/88 16/11 104/81 67/84 11/27 38/25 5/33 8/29 23/16 19/25 11/31 19/31 86/85 27/26 12/25 37/32 27/38 181/121 15/28 7/9 50/67 15/32 75/74 38/31 41/50 13/17 9/5 26/15 76/39 8/33 3/29)


#(70 11.836 #(0 613/409 1 97/195 59/58 57/43 41/51 117/61 8/11 4/47 79/40 23/14 49/58 49/74 
	      8/49 17/36 81/122 45/41 21/31 24/31 16/13 4/17 22/65 22/17 45/37 38/21 27/26 
	      37/20 9/20 4/37 48/49 1/27 76/75 30/17 116/117 4/5 49/32 15/19 50/41 39/38 45/38 
	      3/16 63/38 3/2 11/24 6/7 27/53 56/37 29/20 10/27 4/39 41/25 7/15 8/21 5/24 23/34 
	      9/10 6/19 17/27 19/30 25/13 3/11 11/100 27/19 355/356 23/12 29/42 51/29 87/76 23/45))

#(71 12.441 #(0 32/97 26/17 30/41 37/35 5/17 5/22 39/77 152/101 40/41 19/28 44/31 35/48 2/39 10/33 
	      39/29 7/18 15/22 1/3 55/29 112/59 20/31 4/33 19/10 39/28 78/89 17/18 52/27 71/39 15/53 
	      43/24 6/19 13/19 7/43 48/25 10/11 52/43 69/59 29/23 17/10 35/22 7/4 13/34 32/25 17/22 
	      153/92 117/88 20/29 100/77 46/107 41/23 11/36 39/68 218/131 64/41 85/53 30/29 3/16 6/13 
	      20/17 1/12 1/3 40/39 44/25 39/32 12/35 23/32 25/47 20/13 47/74 10/81))

;1413: 0.172900402763669 12.2759285962205 #<vct[len=71]: 2.921 4.274 0.100 0.786 3.802 0.774 2.175 5.940 0.989 1.486 1.141 2.357 4.717 3.867 4.895 4.199 6.016 5.836 2.542 5.273 0.166 1.537 5.559 3.708 4.636 3.727 3.964 2.389 1.403 5.588 2.020 4.155 0.669 5.580 4.880 3.184 4.484 4.068 0.260 5.893 1.083 6.001 0.082 2.631 1.976 5.992 4.723 2.846 0.508 1.048 2.138 4.384 5.081 5.928 5.202 1.921 3.285 5.664 5.586 2.414 4.262 3.497 3.760 0.935 3.320 6.008 0.086 3.931 3.164 2.068 3.269>
;  rat: #(0 3/2 36/29 17/32 23/41 2/3 9/49 14/31 37/19 27/23 5/37 43/27 41/29 13/61 29/18 11/24 3/28 28/25 8/7 53/49 10/19 1/30 18/47 19/22 14/61 96/95 5/32 29/40 40/27 81/43 20/11 58/37 26/17 5/31 110/109 97/63 43/42 49/25 20/11 15/22 2/9 6/7 1/23 102/53 11/14 42/37 9/5 23/84 3/5 35/19 34/27 24/23 41/122 57/34 17/33 13/24 1/22 73/39 11/12 44/45 7/11 60/41 21/34 26/33 21/34 19/35 19/11 1/44 28/33 124/79 46/45)

#(128 18.937 #(0 114/67 22/29 3/7 10/89 80/47 9/16 17/16 2/27 10/69 
	       11/20 8/17 38/25 78/157 33/29 42/67 29/25 122/65 31/29 
	       23/25 42/23 51/28 32/77 16/81 1/34 6/13 15/49 17/11 6/7 
	       355/237 78/47 5/23 17/20 43/26 67/36 51/32 5/3 39/44 5/3 
	       17/11 28/31 29/18 27/31 3/16 9/22 7/34 199/149 42/25 37/33 
	       6/19 114/79 35/39 49/82 33/32 45/23 26/17 92/55 28/15 85/71 
	       21/73 17/10 17/9 3/28 7/31 27/14 53/105 36/25 41/22 4/7 20/19 
	       4/7 41/25 20/23 4/5 27/43 2/29 4/27 29/21 36/19 2/31 93/56 2/33 
	       20/19 16/11 15/34 33/17 23/19 29/26 20/27 49/25 15/23 25/76 48/67 
	       10/7 2/35 20/13 2/21 27/37 43/65 57/44 35/39 137/96 146/117 37/42 
	       47/24 69/40 18/53 4/3 17/13 81/53 7/18 51/55 19/11 29/23 65/64 
	       55/46 1/7 7/53 19/20 56/33 7/27 79/41 25/21 114/113 35/22 44/43 
	       38/63 1/47))
))

#|
;;; rats!  I notice well along in this project that rxvt is dropping characters!
;;;   gotta test...

(define (test-peak-phases)
  (let ((len (vector-length noid-min-peak-phases)))
    (do ((i 0 (1+ i)))
	((= i len))
      (let ((data (vector-ref noid-min-peak-phases i)))
	(if (not (vector? data))
	    (snd-display ";noid ~D is not a vector: ~A" i data)
	    (let* ((data-len (vector-length data))
		   (n (vector-ref data 0))
		   (amp (vector-ref data 1)))
	      (if (or (< data-len 3)
		      (not (integer? n)))
		  (snd-display ";bad data? ~A" data)
		  (do ((k 1 (1+ k)))
		      ((= k data-len))
		    (let ((val (vector-ref data k)))
		      (if (number? val)
			  (begin
			    (if (and (or (<= val (sqrt n))
					 (>= val n))
				     (not (= n 1)))
				(snd-display ";bad amp ~D ~A ~A" i val data)
				(set! amp val)))
			  (if (not (vector? val))
			      (snd-display ";bad rats: ~D ~A ~A" i val data)
			      (let ((rat-len (vector-length val)))
				(do ((j 0 (1+ j)))
				    ((= j rat-len))
				  (let ((rat (vector-ref val j)))
				    (if (or (not (rational? rat))
					    (< rat 0)
					    (> rat 2)) ; ratio has pi divided out
					(snd-display ";bad rat: j: ~A, k: ~A, i: ~A, rat: ~A in ~A" j k i rat val))))
				(let ((tested-max 0.0)
				      (angle 0.0)
				      (incr (hz->radians 1.0))
				      (cur-min-max-phases (make-vct n)))
				  (do ((m 0 (1+ m)))
				      ((= m n))
				    (vct-set! cur-min-max-phases m (* pi (vector-ref val m))))
				  (do ((m 0 (1+ m)))
				      ((= m 88200))
				    (let ((sum 0.0))
				      (do ((kk 0 (1+ kk)))
					  ((= kk n))
					(set! sum (+ sum (sin (+ (* (+ kk 1) angle) (vct-ref cur-min-max-phases kk))))))
				      (set! tested-max (max tested-max (abs sum))))
				    (set! angle (+ angle incr)))
				  (if (> (abs (- tested-max amp)) .01)
				      (snd-display ";~A ~A ~A" n amp tested-max))
				  )))))))))))))

:(test-peak-phases)
;25 6.0925 6.10638393508127
;47 9.3426 9.35325510723422
;53 9.896 9.90624657140379
;60 10.861 10.8758454540636
;62 10.611 10.6261857321664
;63 11.291 11.3037987420471
;70 11.836 11.8471006488364

|#

#|
;;; these phases were found with the following software
  
(if (not (provided? 'snd-generators.scm)) (load "generators.scm"))
(if (not (provided? 'snd-dsp.scm)) (load "dsp.scm"))


(define* (test-it n cur-min-max cur-min-max-phases :optional tiny)
  (let* ((samps (* n 4096)))
    (set! (print-length) (max (print-length) n))
    (do ((m 0 (1+ m)))
	((or (c-g?) (= m n)))
      
      ;; on nth try going down then up
      (let ((try-up #t))
	(let ((happy #t)
	      (cur-phases (vct-copy cur-min-max-phases))
	      (incr -.01))
	  (do ()
	      ((not happy))
	    (vct-set! cur-phases m (+ (vct-ref cur-phases m) incr))
	    (let* ((mod1 (make-noid (radians->hz (/ (* 2 pi) samps)) n cur-phases))
		   (cur-max 0.0))
	      (run (lambda ()
		     (do ((i 0 (1+ i)))
			 ((= i samps))
		       (set! cur-max (max cur-max (abs (noid mod1 0.0)))))))
	      (if (< cur-max cur-min-max)
		  (begin
		    (set! cur-min-max cur-max)
		    (set! try-up #f)
					;(snd-display ";-max now ~A (~A ~A)" cur-max m (vct-ref cur-phases m))
		    (vct-set! cur-min-max-phases m (vct-ref cur-phases m)))
		  (set! happy #f)))))
	
	(let ((happy #t)
	      (cur-phases (vct-copy cur-min-max-phases))
	      (incr -.001))
	  (do ()
	      ((not happy))
	    (vct-set! cur-phases m (+ (vct-ref cur-phases m) incr))
	    (let* ((mod1 (make-noid (radians->hz (/ (* 2 pi) samps)) n cur-phases))
		   (cur-max 0.0))
	      (run (lambda ()
		     (do ((i 0 (1+ i)))
			 ((= i samps))
		       (set! cur-max (max cur-max (abs (noid mod1 0.0)))))))
	      (if (< cur-max cur-min-max)
		  (begin
		    (set! cur-min-max cur-max)
		    (set! try-up #f)
					;(snd-display ";--max now ~A (~A ~A)" cur-max m (vct-ref cur-phases m))
		    (vct-set! cur-min-max-phases m (vct-ref cur-phases m)))
		  (set! happy #f)))))
	
	(if tiny
	    (let ((happy #t)
		  (cur-phases (vct-copy cur-min-max-phases))
		  (incr -.0001))
	      (do ()
		  ((not happy))
		(vct-set! cur-phases m (+ (vct-ref cur-phases m) incr))
		(let* ((mod1 (make-noid (radians->hz (/ (* 2 pi) samps)) n cur-phases))
		       (cur-max 0.0))
		  (run (lambda ()
			 (do ((i 0 (1+ i)))
			     ((= i samps))
			   (set! cur-max (max cur-max (abs (noid mod1 0.0)))))))
		  (if (< cur-max cur-min-max)
		      (begin
			(set! cur-min-max cur-max)
			(set! try-up #f)
					;(snd-display ";--max now ~A (~A ~A)" cur-max m (vct-ref cur-phases m))
			(vct-set! cur-min-max-phases m (vct-ref cur-phases m)))
		      (set! happy #f))))))
	
	(if try-up
	    (begin
	      (let ((happy #t)
		    (cur-phases (vct-copy cur-min-max-phases))
		    (incr 0.01))
		(do ()
		    ((not happy))
		  (vct-set! cur-phases m (+ (vct-ref cur-phases m) incr))
		  (let* ((mod1 (make-noid (radians->hz (/ (* 2 pi) samps)) n cur-phases))
			 (cur-max 0.0))
		    (run (lambda ()
			   (do ((i 0 (1+ i)))
			       ((= i samps))
			     (set! cur-max (max cur-max (abs (noid mod1 0.0)))))))
		    (if (< cur-max cur-min-max)
			(begin
			  (set! cur-min-max cur-max)
					;(snd-display ";+max now ~A (~A ~A)" cur-max m (vct-ref cur-phases m))
			  (vct-set! cur-min-max-phases m (vct-ref cur-phases m)))
			(set! happy #f)))))
	      
	      (let ((happy #t)
		    (cur-phases (vct-copy cur-min-max-phases))
		    (incr 0.001))
		(do ()
		    ((not happy))
		  (vct-set! cur-phases m (+ (vct-ref cur-phases m) incr))
		  (let* ((mod1 (make-noid (radians->hz (/ (* 2 pi) samps)) n cur-phases))
			 (cur-max 0.0))
		    (run (lambda ()
			   (do ((i 0 (1+ i)))
			       ((= i samps))
			     (set! cur-max (max cur-max (abs (noid mod1 0.0)))))))
		    (if (< cur-max cur-min-max)
			(begin
			  (set! cur-min-max cur-max)
					;(snd-display ";++max now ~A (~A ~A)" cur-max m (vct-ref cur-phases m))
			  (vct-set! cur-min-max-phases m (vct-ref cur-phases m)))
			(set! happy #f)))))
	      
	      (if tiny
		  (let ((happy #t)
			(cur-phases (vct-copy cur-min-max-phases))
			(incr 0.0001))
		    (do ()
			((not happy))
		      (vct-set! cur-phases m (+ (vct-ref cur-phases m) incr))
		      (let* ((mod1 (make-noid (radians->hz (/ (* 2 pi) samps)) n cur-phases))
			     (cur-max 0.0))
			(run (lambda ()
			       (do ((i 0 (1+ i)))
				   ((= i samps))
				 (set! cur-max (max cur-max (abs (noid mod1 0.0)))))))
			(if (< cur-max cur-min-max)
			    (begin
			      (set! cur-min-max cur-max)
					;(snd-display ";++max now ~A (~A ~A)" cur-max m (vct-ref cur-phases m))
			      (vct-set! cur-min-max-phases m (vct-ref cur-phases m)))
			    (set! happy #f))))))))))
    
    (list cur-min-max cur-min-max-phases)))


(define (lrat n mx v)
  
  ;; check that mx is correct
  (set! (print-length) (max (print-length) n))
  
  (let* ((cur-max 0.0)
	 (samps (seconds->samples 2.0))
	 (mod1 (make-noid 1.0 n v))
	 (result (make-vector n)))
    (run 
     (lambda ()
       (do ((i 0 (1+ i)))
	   ((= i samps))
	 (let ((md (noid mod1 0.0)))
	   (set! cur-max (max cur-max (abs md)))))))
    (if (> (abs (- cur-max mx)) .001)
	(snd-display ";initial check mx: ~A, cur: ~A" mx cur-max))
    
    (let ((off (vct-ref v 0)))
      (do ((i 0 (1+ i)))
	  ((= i n))
	(vct-set! v i (fmod (- (vct-ref v i) (* (+ i 1) off)) (* 2 pi)))
	(if (< (vct-ref v i) 0.0) (vct-set! v i (+ (vct-ref v i) (* 2 pi))))))
    
    ;; check that massaged phases are correct
    (set! cur-max 0.0)
    (set! mod1 (make-noid 1.0 n v))
    (run 
     (lambda ()
       (do ((i 0 (1+ i)))
	   ((= i samps))
	 (let ((md (noid mod1 0.0)))
	   (set! cur-max (max cur-max (abs md)))))))
    (if (> (abs (- cur-max mx)) .001)
	(snd-display ";2nd check mx: ~A, cur: ~A" mx cur-max))
    
    (do ((i 0 (1+ i)))
	((= i n))
      (vector-set! result i (rationalize (inexact->exact (/ (vct-ref v i) pi)) 1/1000))
      (vct-set! v i (vector-ref result i)))
    
    ;; check that pi-relative phases are correct
    (set! cur-max 0.0)
    (let ((v1 (vct-copy v)))
      (do ((i 0 (1+ i)))
	  ((= i n))
	(vct-set! v1 i (* pi (vct-ref v i))))
      (set! mod1 (make-noid 1.0 n v1))
      (run 
       (lambda ()
	 (do ((i 0 (1+ i)))
	     ((= i samps))
	   (let ((md (noid mod1 0.0)))
	     (set! cur-max (max cur-max (abs md)))))))
      (if (> (abs (- cur-max mx)) .001)
	  (snd-display ";3rd check mx: ~A, cur: ~A" mx cur-max)))
    
    result))


(define (test-sins n cur-min-maxes)
  (let ((tested-max 0.0)
	(angle 0.0)
	(incr (hz->radians 1.0))
	(cur-min-max-phases (make-vct n)))
    (do ((i 0 (1+ i)))
	((= i n))
      (vct-set! cur-min-max-phases i (* pi (vector-ref cur-min-maxes i))))
    (do ((i 0 (1+ i)))
	((= i 88200))
      (let ((sum 0.0))
	(do ((k 0 (1+ k)))
	    ((= k n))
	  (set! sum (+ sum (sin (+ (* (+ k 1) angle) (vct-ref cur-min-max-phases k))))))
	(set! tested-max (max tested-max (abs sum))))
      (set! angle (+ angle incr)))
    (list tested-max (/ tested-max n))))


(define (try-it n tries)
  (let* (;(n 32)
	 (cur-min-max 100000.0)
	 (cur-min-max-phases (make-vct n))
	 (samps (seconds->samples 2.0)))
    (do ((m 0 (1+ m)))
	((or (c-g?) 
	     (= m tries)))
      (let ((cur-phases (make-vct n)))
	(do ((i 0 (1+ i)))
	    ((= i n))
	  (vct-set! cur-phases i (random (* 2 pi))))
	(let* ((mod1 (make-noid 1.0 n cur-phases))
	       (cur-max 0.0))
	  (run
	   (lambda ()
	     (do ((i 0 (1+ i)))
		 ((= i samps))
	       (set! cur-max (max cur-max (abs (noid mod1 0.0)))))))
	  
					;(snd-display ";1: ~A" cur-max)
	  
	  (if (< cur-max (* 1.25 cur-min-max))
	      (let ((lst (test-it n cur-max cur-phases)))
		(set! cur-max (car lst))
		(set! cur-phases (cadr lst))))
	  
					;(snd-display ";2: ~A" cur-max)
	  
	  (if (< cur-max cur-min-max)
	      (begin
		(set! cur-min-max cur-max)
		(do ((i 0 (1+ i)))
		    ((= i n))
		  (vct-set! cur-min-max-phases i (vct-ref cur-phases i)))
		(set! (print-length) (max (print-length) n))
		(snd-display "~%;~A: ~A ~A ~A"  m cur-min-max (* n cur-min-max) cur-min-max-phases)
		(snd-display ";  rat: ~A" (lrat n cur-min-max (vct-copy cur-min-max-phases))))))))
    
    (list cur-min-max cur-min-max-phases (test-sins n (lrat n cur-min-max (vct-copy cur-min-max-phases))))))


(define (try-it-all start-n tries)
  (do ((i start-n (1+ i)))
      ((c-g?))
    (try-it i tries)))


;;; for n<50 I used 20000 tries
|#

